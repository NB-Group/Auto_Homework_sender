# Auto Homework 增强版构建指南

## 🚀 新功能特性

### ✅ 已实现的功能
- **🖥️ 系统托盘支持**: 应用关闭后常驻托盘，可随时显示界面
- **🔒 单实例模式**: 防止重复启动，点击图标直接显示现有实例
- **⚡ 快速启动**: 优化启动速度，减少加载时间
- **📦 一键打包**: 自动构建可执行文件和安装包
- **🔄 智能开机启动**: 开机自启动直接显示UI，无需选择模式

## 📋 构建要求

### 系统要求
- Windows 10/11
- Python 3.8+
- Inno Setup 6 (用于创建安装包)

### 依赖包
```bash
pip install -r requirements.txt
```

新增依赖：
- `pystray>=0.19.0` - 系统托盘支持
- `Pillow>=9.0.0` - 图像处理

## 🛠️ 构建步骤

### 方法一：一键打包（推荐）
```bash
# 双击运行
build_one_click.bat
```
或
```bash
python build_auto.py
```

### 方法二：手动构建
```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 构建可执行文件
python build_release.py

# 3. 创建安装包
"C:\Program Files (x86)\Inno Setup 6\ISCC.exe" installer_setup.iss
```

## 📁 输出文件

构建成功后将在以下目录生成文件：

```
dist/
├── main.dist/
│   └── AutoHomework.exe          # 主程序可执行文件
└── ...

installer/
└── AutoHomework_Setup_v1.0.0.exe # 安装包
```

## ✨ 使用说明

### 安装后使用
1. **双击运行**: 首次运行会显示主界面
2. **关闭窗口**: 应用会最小化到托盘，不会完全退出
3. **显示界面**: 右键托盘图标 → "显示界面"
4. **退出应用**: 右键托盘图标 → "退出"

### 开机自启动
- 应用会自动设置开机自启动
- 开机后直接显示主界面，无需选择模式
- 可在应用设置中关闭开机自启动

### 单实例保护
- 重复双击exe文件不会创建新实例
- 会自动显示已运行的实例界面

## 🔧 技术实现

### 托盘功能
- 使用 `pystray` 实现系统托盘
- 自定义图标设计
- 右键菜单支持

### 单实例模式
- 使用 socket 绑定检测运行实例
- 进程间通信机制

### 启动优化
- 预加载常用模块
- 环境变量优化
- 减少初始化时间

### 智能打包
- Nuitka 静态编译
- 自动包含所有依赖
- 去除控制台窗口
- 自定义图标

## 🐛 故障排除

### 托盘功能不可用
```bash
pip install pystray Pillow
```

### 构建失败
1. 确保所有依赖已安装
2. 检查 Python 和 Nuitka 版本
3. 查看构建日志中的错误信息

### 安装包创建失败
1. 安装 Inno Setup 6
2. 确保 `ISCC.exe` 在标准路径中

## 📝 更新日志

### v1.1.0 (增强版)
- ✅ 添加系统托盘支持
- ✅ 实现单实例模式
- ✅ 优化启动速度
- ✅ 一键打包脚本
- ✅ 智能开机启动
- ✅ 去除启动模式选择

### v1.0.0 (原版)
- 基础作业自动发送功能
- Web界面
- 定时任务
- 开机自启动

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

本项目采用 MIT 许可证。
